\hypertarget{class_binary_file_handler}{}\doxysection{Binary\+File\+Handler Class Reference}
\label{class_binary_file_handler}\index{BinaryFileHandler@{BinaryFileHandler}}
Inheritance diagram for Binary\+File\+Handler\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_binary_file_handler}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_binary_file_handler_a8995d1aab6edeb1d07205257d899ba5f}{Binary\+File\+Handler}} ()
\item 
\mbox{\hyperlink{class_binary_file_handler_a965643ec1f3e41b71f02ab3bc30ddeb4}{$\sim$\+Binary\+File\+Handler}} () final
\item 
Error \mbox{\hyperlink{class_binary_file_handler_a4129cf2eeac5c792f546db1e43d5433c}{Read\+Header}} (Memory\+Buffer \&Input) final
\item 
Expected$<$ Optional$<$ String\+Ref $>$ $>$ \mbox{\hyperlink{class_binary_file_handler_a9ca3dc3dc36f16258fdd01844531f129}{Read\+Bundle\+Start}} (Memory\+Buffer \&Input) final
\item 
Error \mbox{\hyperlink{class_binary_file_handler_af938c83df04fa66fe04c7e0563ade0f0}{Read\+Bundle\+End}} (Memory\+Buffer \&Input) final
\begin{DoxyCompactList}\small\item\em Read the marker that closes the current bundle. \end{DoxyCompactList}\item 
Error \mbox{\hyperlink{class_binary_file_handler_a03f6f2509a8d6d78e3ab800995f7f779}{Read\+Bundle}} (raw\+\_\+ostream \&OS, Memory\+Buffer \&Input) final
\begin{DoxyCompactList}\small\item\em Read the current bundle and write the result into the stream {\itshape OS}. \end{DoxyCompactList}\item 
Error \mbox{\hyperlink{class_binary_file_handler_ab80cac5e41eaab070a155716de55c84d}{Write\+Header}} (raw\+\_\+fd\+\_\+ostream \&OS, Array\+Ref$<$ std\+::unique\+\_\+ptr$<$ Memory\+Buffer $>$$>$ Inputs) final
\item 
Error \mbox{\hyperlink{class_binary_file_handler_aae0993fd9bf54ca80c3302f5e0810a8e}{Write\+Bundle\+Start}} (raw\+\_\+fd\+\_\+ostream \&OS, String\+Ref Target\+Triple) final
\item 
Error \mbox{\hyperlink{class_binary_file_handler_ae8babe5e1a76494820097329a35f72ae}{Write\+Bundle\+End}} (raw\+\_\+fd\+\_\+ostream \&OS, String\+Ref Target\+Triple) final
\item 
Error \mbox{\hyperlink{class_binary_file_handler_ae293c57008f6d941531c76839d0cd371}{Write\+Bundle}} (raw\+\_\+fd\+\_\+ostream \&OS, Memory\+Buffer \&Input) final
\begin{DoxyCompactList}\small\item\em Write the bundle from {\itshape Input} into {\itshape OS}. \end{DoxyCompactList}\item 
virtual Error \mbox{\hyperlink{class_file_handler_a70cbb9c0347d248c018e52993a13255b}{list\+Bundle\+IDs}} (Memory\+Buffer \&Input)
\begin{DoxyCompactList}\small\item\em List bundle IDs in {\itshape Input}. \end{DoxyCompactList}\item 
Error \mbox{\hyperlink{class_file_handler_a70ed8dd129df99dcd5d5e42fffd7b125}{for\+Each\+Bundle}} (Memory\+Buffer \&Input, std\+::function$<$ Error(const \mbox{\hyperlink{struct_file_handler_1_1_bundle_info}{Bundle\+Info}} \&)$>$ Func)
\begin{DoxyCompactList}\small\item\em For each bundle in {\itshape Input}, do {\itshape Func}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual Error \mbox{\hyperlink{class_file_handler_af0a452c5014ddb59b9558614d21daaed}{list\+Bundle\+IDs\+Callback}} (Memory\+Buffer \&Input, const \mbox{\hyperlink{struct_file_handler_1_1_bundle_info}{Bundle\+Info}} \&Info)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 307 of file Clang\+Offload\+Bundler.\+cpp.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_binary_file_handler_a8995d1aab6edeb1d07205257d899ba5f}\label{class_binary_file_handler_a8995d1aab6edeb1d07205257d899ba5f}} 
\index{BinaryFileHandler@{BinaryFileHandler}!BinaryFileHandler@{BinaryFileHandler}}
\index{BinaryFileHandler@{BinaryFileHandler}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{BinaryFileHandler()}{BinaryFileHandler()}}
{\footnotesize\ttfamily Binary\+File\+Handler\+::\+Binary\+File\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 331 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{331 : \mbox{\hyperlink{class_file_handler_a0d1ac8e9911e19255e8b2d99c2d93f43}{FileHandler}}() \{\}}

\end{DoxyCode}
\mbox{\Hypertarget{class_binary_file_handler_a965643ec1f3e41b71f02ab3bc30ddeb4}\label{class_binary_file_handler_a965643ec1f3e41b71f02ab3bc30ddeb4}} 
\index{BinaryFileHandler@{BinaryFileHandler}!````~BinaryFileHandler@{$\sim$BinaryFileHandler}}
\index{````~BinaryFileHandler@{$\sim$BinaryFileHandler}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{$\sim$BinaryFileHandler()}{~BinaryFileHandler()}}
{\footnotesize\ttfamily Binary\+File\+Handler\+::$\sim$\+Binary\+File\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}}



Definition at line 333 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{333 \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_file_handler_a70ed8dd129df99dcd5d5e42fffd7b125}\label{class_file_handler_a70ed8dd129df99dcd5d5e42fffd7b125}} 
\index{BinaryFileHandler@{BinaryFileHandler}!forEachBundle@{forEachBundle}}
\index{forEachBundle@{forEachBundle}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{forEachBundle()}{forEachBundle()}}
{\footnotesize\ttfamily Error File\+Handler\+::for\+Each\+Bundle (\begin{DoxyParamCaption}\item[{Memory\+Buffer \&}]{Input,  }\item[{std\+::function$<$ Error(const \mbox{\hyperlink{struct_file_handler_1_1_bundle_info}{Bundle\+Info}} \&)$>$}]{Func }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [inherited]}}



For each bundle in {\itshape Input}, do {\itshape Func}. 



Definition at line 234 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{235                                                                    \{}
\DoxyCodeLine{236     \textcolor{keywordflow}{while} (\textcolor{keyword}{true}) \{}
\DoxyCodeLine{237       Expected<Optional<StringRef>> CurTripleOrErr = \mbox{\hyperlink{class_file_handler_a5b31037af59fa8c77b8287d8ae9d84c4}{ReadBundleStart}}(Input);}
\DoxyCodeLine{238       \textcolor{keywordflow}{if} (!CurTripleOrErr)}
\DoxyCodeLine{239         \textcolor{keywordflow}{return} CurTripleOrErr.takeError();}
\DoxyCodeLine{240 }
\DoxyCodeLine{241       \textcolor{comment}{// No more bundles.}}
\DoxyCodeLine{242       \textcolor{keywordflow}{if} (!*CurTripleOrErr)}
\DoxyCodeLine{243         \textcolor{keywordflow}{break};}
\DoxyCodeLine{244 }
\DoxyCodeLine{245       StringRef CurTriple = **CurTripleOrErr;}
\DoxyCodeLine{246       assert(!CurTriple.empty());}
\DoxyCodeLine{247 }
\DoxyCodeLine{248       BundleInfo Info\{CurTriple\};}
\DoxyCodeLine{249       \textcolor{keywordflow}{if} (Error Err = Func(Info))}
\DoxyCodeLine{250         \textcolor{keywordflow}{return} Err;}
\DoxyCodeLine{251     \}}
\DoxyCodeLine{252     \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{253   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_file_handler_a70cbb9c0347d248c018e52993a13255b}\label{class_file_handler_a70cbb9c0347d248c018e52993a13255b}} 
\index{BinaryFileHandler@{BinaryFileHandler}!listBundleIDs@{listBundleIDs}}
\index{listBundleIDs@{listBundleIDs}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{listBundleIDs()}{listBundleIDs()}}
{\footnotesize\ttfamily virtual Error File\+Handler\+::list\+Bundle\+IDs (\begin{DoxyParamCaption}\item[{Memory\+Buffer \&}]{Input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}



List bundle IDs in {\itshape Input}. 



Definition at line 220 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{220                                                    \{}
\DoxyCodeLine{221     \textcolor{keywordflow}{if} (Error Err = \mbox{\hyperlink{class_file_handler_a0b973008bf7d7a53bc33d0f75b0dadef}{ReadHeader}}(Input))}
\DoxyCodeLine{222       \textcolor{keywordflow}{return} Err;}
\DoxyCodeLine{223 }
\DoxyCodeLine{224     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_file_handler_a70ed8dd129df99dcd5d5e42fffd7b125}{forEachBundle}}(Input, [\&](\textcolor{keyword}{const} BundleInfo \&Info) -\/> Error \{}
\DoxyCodeLine{225       llvm::outs() << Info.BundleID << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{226       Error Err = \mbox{\hyperlink{class_file_handler_af0a452c5014ddb59b9558614d21daaed}{listBundleIDsCallback}}(Input, Info);}
\DoxyCodeLine{227       \textcolor{keywordflow}{if} (Err)}
\DoxyCodeLine{228         \textcolor{keywordflow}{return} Err;}
\DoxyCodeLine{229       \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{230     \});}
\DoxyCodeLine{231   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_file_handler_af0a452c5014ddb59b9558614d21daaed}\label{class_file_handler_af0a452c5014ddb59b9558614d21daaed}} 
\index{BinaryFileHandler@{BinaryFileHandler}!listBundleIDsCallback@{listBundleIDsCallback}}
\index{listBundleIDsCallback@{listBundleIDsCallback}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{listBundleIDsCallback()}{listBundleIDsCallback()}}
{\footnotesize\ttfamily virtual Error File\+Handler\+::list\+Bundle\+IDs\+Callback (\begin{DoxyParamCaption}\item[{Memory\+Buffer \&}]{Input,  }\item[{const \mbox{\hyperlink{struct_file_handler_1_1_bundle_info}{Bundle\+Info}} \&}]{Info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}



Reimplemented in \mbox{\hyperlink{class_text_file_handler_a87e2401d42b38125b706e0827723d5ec}{Text\+File\+Handler}}.



Definition at line 256 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{257                                                               \{}
\DoxyCodeLine{258     \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{259   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_binary_file_handler_a03f6f2509a8d6d78e3ab800995f7f779}\label{class_binary_file_handler_a03f6f2509a8d6d78e3ab800995f7f779}} 
\index{BinaryFileHandler@{BinaryFileHandler}!ReadBundle@{ReadBundle}}
\index{ReadBundle@{ReadBundle}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{ReadBundle()}{ReadBundle()}}
{\footnotesize\ttfamily Error Binary\+File\+Handler\+::\+Read\+Bundle (\begin{DoxyParamCaption}\item[{raw\+\_\+ostream \&}]{OS,  }\item[{Memory\+Buffer \&}]{Input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}



Read the current bundle and write the result into the stream {\itshape OS}. 



Implements \mbox{\hyperlink{class_file_handler_a6e4e497d5160eff3cab43dfdfd7e2a13}{File\+Handler}}.



Definition at line 415 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{415                                                                \{}
\DoxyCodeLine{416     assert(CurBundleInfo != BundlesInfo.end() \&\& \textcolor{stringliteral}{"{}Invalid reader info!"{}});}
\DoxyCodeLine{417     StringRef FC = Input.getBuffer();}
\DoxyCodeLine{418     OS.write(FC.data() + CurBundleInfo-\/>second.Offset,}
\DoxyCodeLine{419              CurBundleInfo-\/>second.Size);}
\DoxyCodeLine{420     \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{421   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_binary_file_handler_af938c83df04fa66fe04c7e0563ade0f0}\label{class_binary_file_handler_af938c83df04fa66fe04c7e0563ade0f0}} 
\index{BinaryFileHandler@{BinaryFileHandler}!ReadBundleEnd@{ReadBundleEnd}}
\index{ReadBundleEnd@{ReadBundleEnd}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{ReadBundleEnd()}{ReadBundleEnd()}}
{\footnotesize\ttfamily Error Binary\+File\+Handler\+::\+Read\+Bundle\+End (\begin{DoxyParamCaption}\item[{Memory\+Buffer \&}]{Input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}



Read the marker that closes the current bundle. 



Implements \mbox{\hyperlink{class_file_handler_a0dc30eeb824c348cc6f9bba853c93c41}{File\+Handler}}.



Definition at line 410 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{410                                                  \{}
\DoxyCodeLine{411     assert(CurBundleInfo != BundlesInfo.end() \&\& \textcolor{stringliteral}{"{}Invalid reader info!"{}});}
\DoxyCodeLine{412     \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{413   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_binary_file_handler_a9ca3dc3dc36f16258fdd01844531f129}\label{class_binary_file_handler_a9ca3dc3dc36f16258fdd01844531f129}} 
\index{BinaryFileHandler@{BinaryFileHandler}!ReadBundleStart@{ReadBundleStart}}
\index{ReadBundleStart@{ReadBundleStart}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{ReadBundleStart()}{ReadBundleStart()}}
{\footnotesize\ttfamily Expected$<$Optional$<$String\+Ref$>$ $>$ Binary\+File\+Handler\+::\+Read\+Bundle\+Start (\begin{DoxyParamCaption}\item[{Memory\+Buffer \&}]{Input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}

Read the marker of the next bundled to be read in the file. The bundle name is returned if there is one in the file, or {\ttfamily None} if there are no more bundles to be read. 

Implements \mbox{\hyperlink{class_file_handler_a5b31037af59fa8c77b8287d8ae9d84c4}{File\+Handler}}.



Definition at line 403 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{403                                                                            \{}
\DoxyCodeLine{404     \textcolor{keywordflow}{if} (NextBundleInfo == BundlesInfo.end())}
\DoxyCodeLine{405       \textcolor{keywordflow}{return} None;}
\DoxyCodeLine{406     CurBundleInfo = NextBundleInfo++;}
\DoxyCodeLine{407     \textcolor{keywordflow}{return} CurBundleInfo-\/>first();}
\DoxyCodeLine{408   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_binary_file_handler_a4129cf2eeac5c792f546db1e43d5433c}\label{class_binary_file_handler_a4129cf2eeac5c792f546db1e43d5433c}} 
\index{BinaryFileHandler@{BinaryFileHandler}!ReadHeader@{ReadHeader}}
\index{ReadHeader@{ReadHeader}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{ReadHeader()}{ReadHeader()}}
{\footnotesize\ttfamily Error Binary\+File\+Handler\+::\+Read\+Header (\begin{DoxyParamCaption}\item[{Memory\+Buffer \&}]{Input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}

Update the file handler with information from the header of the bundled file. 

Implements \mbox{\hyperlink{class_file_handler_a0b973008bf7d7a53bc33d0f75b0dadef}{File\+Handler}}.



Definition at line 335 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{335                                               \{}
\DoxyCodeLine{336     StringRef FC = Input.getBuffer();}
\DoxyCodeLine{337 }
\DoxyCodeLine{338     \textcolor{comment}{// Initialize the current bundle with the end of the container.}}
\DoxyCodeLine{339     CurBundleInfo = BundlesInfo.end();}
\DoxyCodeLine{340 }
\DoxyCodeLine{341     \textcolor{comment}{// Check if buffer is smaller than magic string.}}
\DoxyCodeLine{342     \textcolor{keywordtype}{size\_t} ReadChars = \textcolor{keyword}{sizeof}(\mbox{\hyperlink{_clang_offload_bundler_8cpp_a8261baf2ddbb8a17f287149d5415eebf}{OFFLOAD\_BUNDLER\_MAGIC\_STR}}) -\/ 1;}
\DoxyCodeLine{343     \textcolor{keywordflow}{if} (ReadChars > FC.size())}
\DoxyCodeLine{344       \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{345 }
\DoxyCodeLine{346     \textcolor{comment}{// Check if no magic was found.}}
\DoxyCodeLine{347     StringRef Magic(FC.data(), \textcolor{keyword}{sizeof}(\mbox{\hyperlink{_clang_offload_bundler_8cpp_a8261baf2ddbb8a17f287149d5415eebf}{OFFLOAD\_BUNDLER\_MAGIC\_STR}}) -\/ 1);}
\DoxyCodeLine{348     \textcolor{keywordflow}{if} (!Magic.equals(\mbox{\hyperlink{_clang_offload_bundler_8cpp_a8261baf2ddbb8a17f287149d5415eebf}{OFFLOAD\_BUNDLER\_MAGIC\_STR}}))}
\DoxyCodeLine{349       \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{350 }
\DoxyCodeLine{351     \textcolor{comment}{// Read number of bundles.}}
\DoxyCodeLine{352     \textcolor{keywordflow}{if} (ReadChars + 8 > FC.size())}
\DoxyCodeLine{353       \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{354 }
\DoxyCodeLine{355     uint64\_t NumberOfBundles = Read8byteIntegerFromBuffer(FC, ReadChars);}
\DoxyCodeLine{356     ReadChars += 8;}
\DoxyCodeLine{357 }
\DoxyCodeLine{358     \textcolor{comment}{// Read bundle offsets, sizes and triples.}}
\DoxyCodeLine{359     \textcolor{keywordflow}{for} (uint64\_t i = 0; i < NumberOfBundles; ++i) \{}
\DoxyCodeLine{360 }
\DoxyCodeLine{361       \textcolor{comment}{// Read offset.}}
\DoxyCodeLine{362       \textcolor{keywordflow}{if} (ReadChars + 8 > FC.size())}
\DoxyCodeLine{363         \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{364 }
\DoxyCodeLine{365       uint64\_t Offset = Read8byteIntegerFromBuffer(FC, ReadChars);}
\DoxyCodeLine{366       ReadChars += 8;}
\DoxyCodeLine{367 }
\DoxyCodeLine{368       \textcolor{comment}{// Read size.}}
\DoxyCodeLine{369       \textcolor{keywordflow}{if} (ReadChars + 8 > FC.size())}
\DoxyCodeLine{370         \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{371 }
\DoxyCodeLine{372       uint64\_t Size = Read8byteIntegerFromBuffer(FC, ReadChars);}
\DoxyCodeLine{373       ReadChars += 8;}
\DoxyCodeLine{374 }
\DoxyCodeLine{375       \textcolor{comment}{// Read triple size.}}
\DoxyCodeLine{376       \textcolor{keywordflow}{if} (ReadChars + 8 > FC.size())}
\DoxyCodeLine{377         \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{378 }
\DoxyCodeLine{379       uint64\_t TripleSize = Read8byteIntegerFromBuffer(FC, ReadChars);}
\DoxyCodeLine{380       ReadChars += 8;}
\DoxyCodeLine{381 }
\DoxyCodeLine{382       \textcolor{comment}{// Read triple.}}
\DoxyCodeLine{383       \textcolor{keywordflow}{if} (ReadChars + TripleSize > FC.size())}
\DoxyCodeLine{384         \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{385 }
\DoxyCodeLine{386       StringRef Triple(\&FC.data()[ReadChars], TripleSize);}
\DoxyCodeLine{387       ReadChars += TripleSize;}
\DoxyCodeLine{388 }
\DoxyCodeLine{389       \textcolor{comment}{// Check if the offset and size make sense.}}
\DoxyCodeLine{390       \textcolor{keywordflow}{if} (!Offset || Offset + Size > FC.size())}
\DoxyCodeLine{391         \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{392 }
\DoxyCodeLine{393       assert(BundlesInfo.find(Triple) == BundlesInfo.end() \&\&}
\DoxyCodeLine{394              \textcolor{stringliteral}{"{}Triple is duplicated??"{}});}
\DoxyCodeLine{395       BundlesInfo[Triple] = BinaryBundleInfo(Size, Offset);}
\DoxyCodeLine{396     \}}
\DoxyCodeLine{397     \textcolor{comment}{// Set the iterator to where we will start to read.}}
\DoxyCodeLine{398     CurBundleInfo = BundlesInfo.end();}
\DoxyCodeLine{399     NextBundleInfo = BundlesInfo.begin();}
\DoxyCodeLine{400     \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{401   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_binary_file_handler_ae293c57008f6d941531c76839d0cd371}\label{class_binary_file_handler_ae293c57008f6d941531c76839d0cd371}} 
\index{BinaryFileHandler@{BinaryFileHandler}!WriteBundle@{WriteBundle}}
\index{WriteBundle@{WriteBundle}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{WriteBundle()}{WriteBundle()}}
{\footnotesize\ttfamily Error Binary\+File\+Handler\+::\+Write\+Bundle (\begin{DoxyParamCaption}\item[{raw\+\_\+fd\+\_\+ostream \&}]{OS,  }\item[{Memory\+Buffer \&}]{Input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}



Write the bundle from {\itshape Input} into {\itshape OS}. 



Implements \mbox{\hyperlink{class_file_handler_aa308cfef5f3c06d3c15478097799e0e5}{File\+Handler}}.



Definition at line 468 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{468                                                                    \{}
\DoxyCodeLine{469     \textcolor{keyword}{auto} BI = BundlesInfo[CurWriteBundleTarget];}
\DoxyCodeLine{470     OS.seek(BI.Offset);}
\DoxyCodeLine{471     OS.write(Input.getBufferStart(), Input.getBufferSize());}
\DoxyCodeLine{472     \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{473   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_binary_file_handler_ae8babe5e1a76494820097329a35f72ae}\label{class_binary_file_handler_ae8babe5e1a76494820097329a35f72ae}} 
\index{BinaryFileHandler@{BinaryFileHandler}!WriteBundleEnd@{WriteBundleEnd}}
\index{WriteBundleEnd@{WriteBundleEnd}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{WriteBundleEnd()}{WriteBundleEnd()}}
{\footnotesize\ttfamily Error Binary\+File\+Handler\+::\+Write\+Bundle\+End (\begin{DoxyParamCaption}\item[{raw\+\_\+fd\+\_\+ostream \&}]{OS,  }\item[{String\+Ref}]{Target\+Triple }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}

Write the marker that closes a bundle for the triple {\itshape Target\+Triple} to {\itshape OS}. 

Implements \mbox{\hyperlink{class_file_handler_a716f51f009426d516f30cd7527f25681}{File\+Handler}}.



Definition at line 464 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{464                                                                          \{}
\DoxyCodeLine{465     \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{466   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_binary_file_handler_aae0993fd9bf54ca80c3302f5e0810a8e}\label{class_binary_file_handler_aae0993fd9bf54ca80c3302f5e0810a8e}} 
\index{BinaryFileHandler@{BinaryFileHandler}!WriteBundleStart@{WriteBundleStart}}
\index{WriteBundleStart@{WriteBundleStart}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{WriteBundleStart()}{WriteBundleStart()}}
{\footnotesize\ttfamily Error Binary\+File\+Handler\+::\+Write\+Bundle\+Start (\begin{DoxyParamCaption}\item[{raw\+\_\+fd\+\_\+ostream \&}]{OS,  }\item[{String\+Ref}]{Target\+Triple }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}

Write the marker that initiates a bundle for the triple {\itshape Target\+Triple} to {\itshape OS}. 

Implements \mbox{\hyperlink{class_file_handler_a023196b877e9ab83859f7194e9b38d9e}{File\+Handler}}.



Definition at line 459 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{459                                                                            \{}
\DoxyCodeLine{460     CurWriteBundleTarget = TargetTriple.str();}
\DoxyCodeLine{461     \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{462   \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_binary_file_handler_ab80cac5e41eaab070a155716de55c84d}\label{class_binary_file_handler_ab80cac5e41eaab070a155716de55c84d}} 
\index{BinaryFileHandler@{BinaryFileHandler}!WriteHeader@{WriteHeader}}
\index{WriteHeader@{WriteHeader}!BinaryFileHandler@{BinaryFileHandler}}
\doxysubsubsection{\texorpdfstring{WriteHeader()}{WriteHeader()}}
{\footnotesize\ttfamily Error Binary\+File\+Handler\+::\+Write\+Header (\begin{DoxyParamCaption}\item[{raw\+\_\+fd\+\_\+ostream \&}]{OS,  }\item[{Array\+Ref$<$ std\+::unique\+\_\+ptr$<$ Memory\+Buffer $>$$>$}]{Inputs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}

Write the header of the bundled file to {\itshape OS} based on the information gathered from {\itshape Inputs}. 

Implements \mbox{\hyperlink{class_file_handler_ab587b57538b319ab796b4f9ac060db56}{File\+Handler}}.



Definition at line 423 of file Clang\+Offload\+Bundler.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{424                                                                         \{}
\DoxyCodeLine{425     \textcolor{comment}{// Compute size of the header.}}
\DoxyCodeLine{426     uint64\_t HeaderSize = 0;}
\DoxyCodeLine{427 }
\DoxyCodeLine{428     HeaderSize += \textcolor{keyword}{sizeof}(\mbox{\hyperlink{_clang_offload_bundler_8cpp_a8261baf2ddbb8a17f287149d5415eebf}{OFFLOAD\_BUNDLER\_MAGIC\_STR}}) -\/ 1;}
\DoxyCodeLine{429     HeaderSize += 8; \textcolor{comment}{// Number of Bundles}}
\DoxyCodeLine{430 }
\DoxyCodeLine{431     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&T : TargetNames) \{}
\DoxyCodeLine{432       HeaderSize += 3 * 8; \textcolor{comment}{// Bundle offset, Size of bundle and size of triple.}}
\DoxyCodeLine{433       HeaderSize += T.size(); \textcolor{comment}{// The triple.}}
\DoxyCodeLine{434     \}}
\DoxyCodeLine{435 }
\DoxyCodeLine{436     \textcolor{comment}{// Write to the buffer the header.}}
\DoxyCodeLine{437     OS << \mbox{\hyperlink{_clang_offload_bundler_8cpp_a8261baf2ddbb8a17f287149d5415eebf}{OFFLOAD\_BUNDLER\_MAGIC\_STR}};}
\DoxyCodeLine{438 }
\DoxyCodeLine{439     Write8byteIntegerToBuffer(OS, TargetNames.size());}
\DoxyCodeLine{440 }
\DoxyCodeLine{441     \textcolor{keywordtype}{unsigned} Idx = 0;}
\DoxyCodeLine{442     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&T : TargetNames) \{}
\DoxyCodeLine{443       MemoryBuffer \&MB = *Inputs[Idx++];}
\DoxyCodeLine{444       HeaderSize = alignTo(HeaderSize, BundleAlignment);}
\DoxyCodeLine{445       \textcolor{comment}{// Bundle offset.}}
\DoxyCodeLine{446       Write8byteIntegerToBuffer(OS, HeaderSize);}
\DoxyCodeLine{447       \textcolor{comment}{// Size of the bundle (adds to the next bundle's offset)}}
\DoxyCodeLine{448       Write8byteIntegerToBuffer(OS, MB.getBufferSize());}
\DoxyCodeLine{449       BundlesInfo[T] = BinaryBundleInfo(MB.getBufferSize(), HeaderSize);}
\DoxyCodeLine{450       HeaderSize += MB.getBufferSize();}
\DoxyCodeLine{451       \textcolor{comment}{// Size of the triple}}
\DoxyCodeLine{452       Write8byteIntegerToBuffer(OS, T.size());}
\DoxyCodeLine{453       \textcolor{comment}{// Triple}}
\DoxyCodeLine{454       OS << T;}
\DoxyCodeLine{455     \}}
\DoxyCodeLine{456     \textcolor{keywordflow}{return} Error::success();}
\DoxyCodeLine{457   \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/\+Users/maximilian/clang-\/llvm/clang/tools/clang-\/offload-\/bundler/\mbox{\hyperlink{_clang_offload_bundler_8cpp}{Clang\+Offload\+Bundler.\+cpp}}\end{DoxyCompactItemize}
