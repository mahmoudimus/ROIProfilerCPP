\hypertarget{cc1__main_8cpp}{}\doxysection{/\+Users/maximilian/clang-\/llvm/clang/tools/driver/cc1\+\_\+main.cpp File Reference}
\label{cc1__main_8cpp}\index{/Users/maximilian/clang-\/llvm/clang/tools/driver/cc1\_main.cpp@{/Users/maximilian/clang-\/llvm/clang/tools/driver/cc1\_main.cpp}}
{\ttfamily \#include \char`\"{}clang/\+Basic/\+Stack.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Basic/\+Target\+Options.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Code\+Gen/\+Object\+File\+PCHContainer\+Operations.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Config/config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Driver/\+Driver\+Diagnostic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Driver/\+Options.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Frontend/\+Compiler\+Instance.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Frontend/\+Compiler\+Invocation.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Frontend/\+Frontend\+Diagnostic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Frontend/\+Text\+Diagnostic\+Buffer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Frontend/\+Text\+Diagnostic\+Printer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Frontend/\+Utils.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}clang/\+Frontend\+Tool/\+Utils.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+ADT/\+Statistic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Config/llvm-\/config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Link\+All\+Passes.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Option/\+Arg.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Option/\+Arg\+List.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Option/\+Opt\+Table.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Bury\+Pointer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Compiler.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Error\+Handling.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Managed\+Static.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Path.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Process.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Signals.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Target\+Registry.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Target\+Select.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Time\+Profiler.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/\+Timer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Support/raw\+\_\+ostream.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}llvm/\+Target/\+Target\+Machine.\+h\char`\"{}}\newline
{\ttfamily \#include $<$cstdio$>$}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{cc1__main_8cpp_a86ac52e41ae670905ca66a8bf1eb04b9}{cc1\+\_\+main}} (Array\+Ref$<$ const char $\ast$ $>$ Argv, const char $\ast$Argv0, void $\ast$Main\+Addr)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{cc1__main_8cpp_a86ac52e41ae670905ca66a8bf1eb04b9}\label{cc1__main_8cpp_a86ac52e41ae670905ca66a8bf1eb04b9}} 
\index{cc1\_main.cpp@{cc1\_main.cpp}!cc1\_main@{cc1\_main}}
\index{cc1\_main@{cc1\_main}!cc1\_main.cpp@{cc1\_main.cpp}}
\doxysubsubsection{\texorpdfstring{cc1\_main()}{cc1\_main()}}
{\footnotesize\ttfamily int cc1\+\_\+main (\begin{DoxyParamCaption}\item[{Array\+Ref$<$ const char $\ast$ $>$}]{Argv,  }\item[{const char $\ast$}]{Argv0,  }\item[{void $\ast$}]{Main\+Addr }\end{DoxyParamCaption})}



Definition at line 184 of file cc1\+\_\+main.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{184                                                                              \{}
\DoxyCodeLine{185   ensureSufficientStack();}
\DoxyCodeLine{186 }
\DoxyCodeLine{187   std::unique\_ptr<CompilerInstance> Clang(\textcolor{keyword}{new} CompilerInstance());}
\DoxyCodeLine{188   IntrusiveRefCntPtr<DiagnosticIDs> DiagID(\textcolor{keyword}{new} DiagnosticIDs());}
\DoxyCodeLine{189 }
\DoxyCodeLine{190   \textcolor{comment}{// Register the support for object-\/file-\/wrapped Clang modules.}}
\DoxyCodeLine{191   \textcolor{keyword}{auto} PCHOps = Clang-\/>getPCHContainerOperations();}
\DoxyCodeLine{192   PCHOps-\/>registerWriter(std::make\_unique<ObjectFilePCHContainerWriter>());}
\DoxyCodeLine{193   PCHOps-\/>registerReader(std::make\_unique<ObjectFilePCHContainerReader>());}
\DoxyCodeLine{194 }
\DoxyCodeLine{195   \textcolor{comment}{// Initialize targets first, so that -\/-\/version shows registered targets.}}
\DoxyCodeLine{196   llvm::InitializeAllTargets();}
\DoxyCodeLine{197   llvm::InitializeAllTargetMCs();}
\DoxyCodeLine{198   llvm::InitializeAllAsmPrinters();}
\DoxyCodeLine{199   llvm::InitializeAllAsmParsers();}
\DoxyCodeLine{200 }
\DoxyCodeLine{201   \textcolor{comment}{// Buffer diagnostics from argument parsing so that we can output them using a}}
\DoxyCodeLine{202   \textcolor{comment}{// well formed diagnostic object.}}
\DoxyCodeLine{203   IntrusiveRefCntPtr<DiagnosticOptions> DiagOpts = \textcolor{keyword}{new} DiagnosticOptions();}
\DoxyCodeLine{204   TextDiagnosticBuffer *DiagsBuffer = \textcolor{keyword}{new} TextDiagnosticBuffer;}
\DoxyCodeLine{205   DiagnosticsEngine Diags(DiagID, \&*DiagOpts, DiagsBuffer);}
\DoxyCodeLine{206 }
\DoxyCodeLine{207   \textcolor{comment}{// Setup round-\/trip remarks for the DiagnosticsEngine used in CreateFromArgs.}}
\DoxyCodeLine{208   \textcolor{keywordflow}{if} (find(Argv, StringRef(\textcolor{stringliteral}{"{}-\/Rround-\/trip-\/cc1-\/args"{}})) != Argv.end())}
\DoxyCodeLine{209     Diags.setSeverity(diag::remark\_cc1\_round\_trip\_generated,}
\DoxyCodeLine{210                       diag::Severity::Remark, \{\});}
\DoxyCodeLine{211 }
\DoxyCodeLine{212   \textcolor{keywordtype}{bool} Success = CompilerInvocation::CreateFromArgs(Clang-\/>getInvocation(),}
\DoxyCodeLine{213                                                     Argv, Diags, Argv0);}
\DoxyCodeLine{214 }
\DoxyCodeLine{215   \textcolor{keywordflow}{if} (Clang-\/>getFrontendOpts().TimeTrace) \{}
\DoxyCodeLine{216     llvm::timeTraceProfilerInitialize(}
\DoxyCodeLine{217         Clang-\/>getFrontendOpts().TimeTraceGranularity, Argv0);}
\DoxyCodeLine{218   \}}
\DoxyCodeLine{219   \textcolor{comment}{// -\/-\/print-\/supported-\/cpus takes priority over the actual compilation.}}
\DoxyCodeLine{220   \textcolor{keywordflow}{if} (Clang-\/>getFrontendOpts().PrintSupportedCPUs)}
\DoxyCodeLine{221     \textcolor{keywordflow}{return} PrintSupportedCPUs(Clang-\/>getTargetOpts().Triple);}
\DoxyCodeLine{222 }
\DoxyCodeLine{223   \textcolor{comment}{// Infer the builtin include path if unspecified.}}
\DoxyCodeLine{224   \textcolor{keywordflow}{if} (Clang-\/>getHeaderSearchOpts().UseBuiltinIncludes \&\&}
\DoxyCodeLine{225       Clang-\/>getHeaderSearchOpts().ResourceDir.empty())}
\DoxyCodeLine{226     Clang-\/>getHeaderSearchOpts().ResourceDir =}
\DoxyCodeLine{227       CompilerInvocation::GetResourcesPath(Argv0, MainAddr);}
\DoxyCodeLine{228 }
\DoxyCodeLine{229   \textcolor{comment}{// Create the actual diagnostics engine.}}
\DoxyCodeLine{230   Clang-\/>createDiagnostics();}
\DoxyCodeLine{231   \textcolor{keywordflow}{if} (!Clang-\/>hasDiagnostics())}
\DoxyCodeLine{232     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{233 }
\DoxyCodeLine{234   \textcolor{comment}{// Set an error handler, so that any LLVM backend diagnostics go through our}}
\DoxyCodeLine{235   \textcolor{comment}{// error handler.}}
\DoxyCodeLine{236   llvm::install\_fatal\_error\_handler(LLVMErrorHandler,}
\DoxyCodeLine{237                                   \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{void}*\textcolor{keyword}{>}(\&Clang-\/>getDiagnostics()));}
\DoxyCodeLine{238 }
\DoxyCodeLine{239   DiagsBuffer-\/>FlushDiagnostics(Clang-\/>getDiagnostics());}
\DoxyCodeLine{240   \textcolor{keywordflow}{if} (!Success)}
\DoxyCodeLine{241     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{242 }
\DoxyCodeLine{243   \textcolor{comment}{// Execute the frontend actions.}}
\DoxyCodeLine{244   \{}
\DoxyCodeLine{245     llvm::TimeTraceScope TimeScope(\textcolor{stringliteral}{"{}ExecuteCompiler"{}});}
\DoxyCodeLine{246     Success = ExecuteCompilerInvocation(Clang.get());}
\DoxyCodeLine{247   \}}
\DoxyCodeLine{248 }
\DoxyCodeLine{249   \textcolor{comment}{// If any timers were active but haven't been destroyed yet, print their}}
\DoxyCodeLine{250   \textcolor{comment}{// results now.  This happens in -\/disable-\/free mode.}}
\DoxyCodeLine{251   llvm::TimerGroup::printAll(llvm::errs());}
\DoxyCodeLine{252   llvm::TimerGroup::clearAll();}
\DoxyCodeLine{253 }
\DoxyCodeLine{254   \textcolor{keywordflow}{if} (llvm::timeTraceProfilerEnabled()) \{}
\DoxyCodeLine{255     SmallString<128> Path(Clang-\/>getFrontendOpts().OutputFile);}
\DoxyCodeLine{256     llvm::sys::path::replace\_extension(Path, \textcolor{stringliteral}{"{}json"{}});}
\DoxyCodeLine{257     \textcolor{keywordflow}{if} (\textcolor{keyword}{auto} profilerOutput = Clang-\/>createOutputFile(}
\DoxyCodeLine{258             Path.str(), \textcolor{comment}{/*Binary=*/}\textcolor{keyword}{false}, \textcolor{comment}{/*RemoveFileOnSignal=*/}\textcolor{keyword}{false},}
\DoxyCodeLine{259             \textcolor{comment}{/*useTemporary=*/}\textcolor{keyword}{false})) \{}
\DoxyCodeLine{260       llvm::timeTraceProfilerWrite(*profilerOutput);}
\DoxyCodeLine{261       \textcolor{comment}{// FIXME(ibiryukov): make profilerOutput flush in destructor instead.}}
\DoxyCodeLine{262       profilerOutput-\/>flush();}
\DoxyCodeLine{263       llvm::timeTraceProfilerCleanup();}
\DoxyCodeLine{264       Clang-\/>clearOutputFiles(\textcolor{keyword}{false});}
\DoxyCodeLine{265     \}}
\DoxyCodeLine{266   \}}
\DoxyCodeLine{267 }
\DoxyCodeLine{268   \textcolor{comment}{// Our error handler depends on the Diagnostics object, which we're}}
\DoxyCodeLine{269   \textcolor{comment}{// potentially about to delete. Uninstall the handler now so that any}}
\DoxyCodeLine{270   \textcolor{comment}{// later errors use the default handling behavior instead.}}
\DoxyCodeLine{271   llvm::remove\_fatal\_error\_handler();}
\DoxyCodeLine{272 }
\DoxyCodeLine{273   \textcolor{comment}{// When running with -\/disable-\/free, don't do any destruction or shutdown.}}
\DoxyCodeLine{274   \textcolor{keywordflow}{if} (Clang-\/>getFrontendOpts().DisableFree) \{}
\DoxyCodeLine{275     llvm::BuryPointer(std::move(Clang));}
\DoxyCodeLine{276     \textcolor{keywordflow}{return} !Success;}
\DoxyCodeLine{277   \}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279   \textcolor{keywordflow}{return} !Success;}
\DoxyCodeLine{280 \}}

\end{DoxyCode}
