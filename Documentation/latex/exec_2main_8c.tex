\hypertarget{exec_2main_8c}{}\doxysection{/\+Users/maximilian/clang-\/llvm/clang/tools/scan-\/build-\/py/tests/functional/exec/main.c File Reference}
\label{exec_2main_8c}\index{/Users/maximilian/clang-\/llvm/clang/tools/scan-\/build-\/py/tests/functional/exec/main.c@{/Users/maximilian/clang-\/llvm/clang/tools/scan-\/build-\/py/tests/functional/exec/main.c}}
{\ttfamily \#include \char`\"{}config.\+h\char`\"{}}\newline
{\ttfamily \#include $<$sys/wait.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$paths.\+h$>$}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{exec_2main_8c_aa86e8c19df1b6c0a13cd0123d7da61ce}{FORK}}(FUNC)
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef void($\ast$ \mbox{\hyperlink{exec_2main_8c_aee7ecb4c93e15a61ec544fc01296047e}{exec\+\_\+fun}}) ()
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
char $\ast$$\ast$ \mbox{\hyperlink{exec_2main_8c_a05ff887a5cf1186f4994ff4978e0babd}{get\+\_\+environ}} ()
\item 
void \mbox{\hyperlink{exec_2main_8c_abc2ce631a5451a2b3d28a0177a10b9a3}{expected\+\_\+out\+\_\+open}} (const char $\ast$expected)
\item 
void \mbox{\hyperlink{exec_2main_8c_ae9fedc92bf36b0cbea0df186b69b092d}{expected\+\_\+out\+\_\+close}} ()
\item 
void \mbox{\hyperlink{exec_2main_8c_ac1d1732f8dc7e2d87bc76f5697da0a29}{expected\+\_\+out}} (const char $\ast$file)
\item 
void \mbox{\hyperlink{exec_2main_8c_a2fb86383e6dae94c25d1816218001fdf}{create\+\_\+source}} (char $\ast$file)
\item 
void \mbox{\hyperlink{exec_2main_8c_acbe7e21c386275cdd7ca214c0ca60daa}{wait\+\_\+for}} (pid\+\_\+t child)
\item 
int \mbox{\hyperlink{exec_2main_8c_af3ed9c200de85b53c94cd18764b246a2}{main}} (int argc, char $\ast$const argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
char $\ast$$\ast$ \mbox{\hyperlink{exec_2main_8c_aa006daaf11f1e2e45a6ababaf463212b}{environ}}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{exec_2main_8c_aa86e8c19df1b6c0a13cd0123d7da61ce}\label{exec_2main_8c_aa86e8c19df1b6c0a13cd0123d7da61ce}} 
\index{main.c@{main.c}!FORK@{FORK}}
\index{FORK@{FORK}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{FORK}{FORK}}
{\footnotesize\ttfamily \#define FORK(\begin{DoxyParamCaption}\item[{}]{FUNC }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{    \{                                                                          \(\backslash\)}
\DoxyCodeLine{        pid\_t child = fork();                                                  \(\backslash\)}
\DoxyCodeLine{        if (-\/1 == child) \{                                                     \(\backslash\)}
\DoxyCodeLine{            perror(\textcolor{stringliteral}{"{}fork"{}});                                                    \(\backslash\)}
\DoxyCodeLine{            exit(EXIT\_FAILURE);                                                \(\backslash\)}
\DoxyCodeLine{        \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (0 == child) \{                                               \(\backslash\)}
\DoxyCodeLine{            FUNC fprintf(stderr, \textcolor{stringliteral}{"{}children process failed to exec\(\backslash\)n"{}});         \(\backslash\)}
\DoxyCodeLine{            exit(EXIT\_FAILURE);                                                \(\backslash\)}
\DoxyCodeLine{        \} \textcolor{keywordflow}{else} \{                                                               \(\backslash\)}
\DoxyCodeLine{            wait\_for(child);                                                   \(\backslash\)}
\DoxyCodeLine{        \}                                                                      \(\backslash\)}
\DoxyCodeLine{    \}}

\end{DoxyCode}


Definition at line 97 of file main.\+c.



\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{exec_2main_8c_aee7ecb4c93e15a61ec544fc01296047e}\label{exec_2main_8c_aee7ecb4c93e15a61ec544fc01296047e}} 
\index{main.c@{main.c}!exec\_fun@{exec\_fun}}
\index{exec\_fun@{exec\_fun}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{exec\_fun}{exec\_fun}}
{\footnotesize\ttfamily typedef void($\ast$ exec\+\_\+fun) ()}



Definition at line 83 of file main.\+c.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{exec_2main_8c_a2fb86383e6dae94c25d1816218001fdf}\label{exec_2main_8c_a2fb86383e6dae94c25d1816218001fdf}} 
\index{main.c@{main.c}!create\_source@{create\_source}}
\index{create\_source@{create\_source}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{create\_source()}{create\_source()}}
{\footnotesize\ttfamily void create\+\_\+source (\begin{DoxyParamCaption}\item[{char $\ast$}]{file }\end{DoxyParamCaption})}



Definition at line 73 of file main.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{73                                \{}
\DoxyCodeLine{74     FILE *fd = fopen(file, \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{75     \textcolor{keywordflow}{if} (!fd) \{}
\DoxyCodeLine{76         perror(\textcolor{stringliteral}{"{}fopen"{}});}
\DoxyCodeLine{77         exit(EXIT\_FAILURE);}
\DoxyCodeLine{78     \}}
\DoxyCodeLine{79     fprintf(fd, \textcolor{stringliteral}{"{}typedef int score;\(\backslash\)n"{}});}
\DoxyCodeLine{80     fclose(fd);}
\DoxyCodeLine{81 \}}

\end{DoxyCode}
\mbox{\Hypertarget{exec_2main_8c_ac1d1732f8dc7e2d87bc76f5697da0a29}\label{exec_2main_8c_ac1d1732f8dc7e2d87bc76f5697da0a29}} 
\index{main.c@{main.c}!expected\_out@{expected\_out}}
\index{expected\_out@{expected\_out}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{expected\_out()}{expected\_out()}}
{\footnotesize\ttfamily void expected\+\_\+out (\begin{DoxyParamCaption}\item[{const char $\ast$}]{file }\end{DoxyParamCaption})}



Definition at line 60 of file main.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{60                                     \{}
\DoxyCodeLine{61     \textcolor{keywordflow}{if} (need\_comma)}
\DoxyCodeLine{62         fprintf(fd, \textcolor{stringliteral}{"{},\(\backslash\)n"{}});}
\DoxyCodeLine{63     \textcolor{keywordflow}{else}}
\DoxyCodeLine{64         need\_comma = 1;}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     fprintf(fd, \textcolor{stringliteral}{"{}\{\(\backslash\)n"{}});}
\DoxyCodeLine{67     fprintf(fd, \textcolor{stringliteral}{"{}  \(\backslash\)"{}directory\(\backslash\)"{}: \(\backslash\)"{}\%s\(\backslash\)"{},\(\backslash\)n"{}}, cwd);}
\DoxyCodeLine{68     fprintf(fd, \textcolor{stringliteral}{"{}  \(\backslash\)"{}command\(\backslash\)"{}: \(\backslash\)"{}cc -\/c \%s\(\backslash\)"{},\(\backslash\)n"{}}, file);}
\DoxyCodeLine{69     fprintf(fd, \textcolor{stringliteral}{"{}  \(\backslash\)"{}file\(\backslash\)"{}: \(\backslash\)"{}\%s/\%s\(\backslash\)"{}\(\backslash\)n"{}}, cwd, file);}
\DoxyCodeLine{70     fprintf(fd, \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}});}
\DoxyCodeLine{71 \}}

\end{DoxyCode}
\mbox{\Hypertarget{exec_2main_8c_ae9fedc92bf36b0cbea0df186b69b092d}\label{exec_2main_8c_ae9fedc92bf36b0cbea0df186b69b092d}} 
\index{main.c@{main.c}!expected\_out\_close@{expected\_out\_close}}
\index{expected\_out\_close@{expected\_out\_close}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{expected\_out\_close()}{expected\_out\_close()}}
{\footnotesize\ttfamily void expected\+\_\+out\+\_\+close (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 51 of file main.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{51                           \{}
\DoxyCodeLine{52     fprintf(fd, \textcolor{stringliteral}{"{}]\(\backslash\)n"{}});}
\DoxyCodeLine{53     fclose(fd);}
\DoxyCodeLine{54     fd = NULL;}
\DoxyCodeLine{55 }
\DoxyCodeLine{56     free((\textcolor{keywordtype}{void} *)cwd);}
\DoxyCodeLine{57     cwd = NULL;}
\DoxyCodeLine{58 \}}

\end{DoxyCode}


Referenced by main().

\mbox{\Hypertarget{exec_2main_8c_abc2ce631a5451a2b3d28a0177a10b9a3}\label{exec_2main_8c_abc2ce631a5451a2b3d28a0177a10b9a3}} 
\index{main.c@{main.c}!expected\_out\_open@{expected\_out\_open}}
\index{expected\_out\_open@{expected\_out\_open}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{expected\_out\_open()}{expected\_out\_open()}}
{\footnotesize\ttfamily void expected\+\_\+out\+\_\+open (\begin{DoxyParamCaption}\item[{const char $\ast$}]{expected }\end{DoxyParamCaption})}



Definition at line 40 of file main.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{40                                              \{}
\DoxyCodeLine{41     cwd = getcwd(NULL, 0);}
\DoxyCodeLine{42     fd = fopen(expected, \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{43     \textcolor{keywordflow}{if} (!fd) \{}
\DoxyCodeLine{44         perror(\textcolor{stringliteral}{"{}fopen"{}});}
\DoxyCodeLine{45         exit(EXIT\_FAILURE);}
\DoxyCodeLine{46     \}}
\DoxyCodeLine{47     fprintf(fd, \textcolor{stringliteral}{"{}[\(\backslash\)n"{}});}
\DoxyCodeLine{48     need\_comma = 0;}
\DoxyCodeLine{49 \}}

\end{DoxyCode}


Referenced by main().

\mbox{\Hypertarget{exec_2main_8c_a05ff887a5cf1186f4994ff4978e0babd}\label{exec_2main_8c_a05ff887a5cf1186f4994ff4978e0babd}} 
\index{main.c@{main.c}!get\_environ@{get\_environ}}
\index{get\_environ@{get\_environ}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{get\_environ()}{get\_environ()}}
{\footnotesize\ttfamily char$\ast$$\ast$ get\+\_\+environ (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 26 of file main.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{26                      \{}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#ifdef HAVE\_NSGETENVIRON}}
\DoxyCodeLine{28     \textcolor{keywordflow}{return} *\_NSGetEnviron();}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{30     \textcolor{keywordflow}{return} \mbox{\hyperlink{exec_2main_8c_aa006daaf11f1e2e45a6ababaf463212b}{environ}};}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{32 \}}

\end{DoxyCode}


References environ.

\mbox{\Hypertarget{exec_2main_8c_af3ed9c200de85b53c94cd18764b246a2}\label{exec_2main_8c_af3ed9c200de85b53c94cd18764b246a2}} 
\index{main.c@{main.c}!main@{main}}
\index{main@{main}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$const}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}



Definition at line 266 of file main.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{266                                        \{}
\DoxyCodeLine{267     \textcolor{keywordflow}{if} (argc != 2)}
\DoxyCodeLine{268         exit(EXIT\_FAILURE);}
\DoxyCodeLine{269 }
\DoxyCodeLine{270     \mbox{\hyperlink{exec_2main_8c_abc2ce631a5451a2b3d28a0177a10b9a3}{expected\_out\_open}}(argv[1]);}
\DoxyCodeLine{271 \textcolor{preprocessor}{\#ifdef HAVE\_EXECV}}
\DoxyCodeLine{272     call\_execv();}
\DoxyCodeLine{273 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{274 \textcolor{preprocessor}{\#ifdef HAVE\_EXECVE}}
\DoxyCodeLine{275     call\_execve();}
\DoxyCodeLine{276 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{277 \textcolor{preprocessor}{\#ifdef HAVE\_EXECVP}}
\DoxyCodeLine{278     call\_execvp();}
\DoxyCodeLine{279 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{280 \textcolor{preprocessor}{\#ifdef HAVE\_EXECVP2}}
\DoxyCodeLine{281     call\_execvP();}
\DoxyCodeLine{282 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{283 \textcolor{preprocessor}{\#ifdef HAVE\_EXECVPE}}
\DoxyCodeLine{284     call\_execvpe();}
\DoxyCodeLine{285 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{286 \textcolor{preprocessor}{\#ifdef HAVE\_EXECT}}
\DoxyCodeLine{287     call\_exect();}
\DoxyCodeLine{288 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{289 \textcolor{preprocessor}{\#ifdef HAVE\_EXECL}}
\DoxyCodeLine{290     call\_execl();}
\DoxyCodeLine{291 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{292 \textcolor{preprocessor}{\#ifdef HAVE\_EXECLP}}
\DoxyCodeLine{293     call\_execlp();}
\DoxyCodeLine{294 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{295 \textcolor{preprocessor}{\#ifdef HAVE\_EXECLE}}
\DoxyCodeLine{296     call\_execle();}
\DoxyCodeLine{297 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{298 \textcolor{preprocessor}{\#ifdef HAVE\_POSIX\_SPAWN}}
\DoxyCodeLine{299     call\_posix\_spawn();}
\DoxyCodeLine{300 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{301 \textcolor{preprocessor}{\#ifdef HAVE\_POSIX\_SPAWNP}}
\DoxyCodeLine{302     call\_posix\_spawnp();}
\DoxyCodeLine{303 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{304     \mbox{\hyperlink{exec_2main_8c_ae9fedc92bf36b0cbea0df186b69b092d}{expected\_out\_close}}();}
\DoxyCodeLine{305     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{306 \}}

\end{DoxyCode}


References expected\+\_\+out\+\_\+close(), and expected\+\_\+out\+\_\+open().

\mbox{\Hypertarget{exec_2main_8c_acbe7e21c386275cdd7ca214c0ca60daa}\label{exec_2main_8c_acbe7e21c386275cdd7ca214c0ca60daa}} 
\index{main.c@{main.c}!wait\_for@{wait\_for}}
\index{wait\_for@{wait\_for}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{wait\_for()}{wait\_for()}}
{\footnotesize\ttfamily void wait\+\_\+for (\begin{DoxyParamCaption}\item[{pid\+\_\+t}]{child }\end{DoxyParamCaption})}



Definition at line 85 of file main.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{85                            \{}
\DoxyCodeLine{86     \textcolor{keywordtype}{int} status;}
\DoxyCodeLine{87     \textcolor{keywordflow}{if} (-\/1 == waitpid(child, \&status, 0)) \{}
\DoxyCodeLine{88         perror(\textcolor{stringliteral}{"{}wait"{}});}
\DoxyCodeLine{89         exit(EXIT\_FAILURE);}
\DoxyCodeLine{90     \}}
\DoxyCodeLine{91     \textcolor{keywordflow}{if} (WIFEXITED(status) ? WEXITSTATUS(status) : EXIT\_FAILURE) \{}
\DoxyCodeLine{92         fprintf(stderr, \textcolor{stringliteral}{"{}children process has non zero exit code\(\backslash\)n"{}});}
\DoxyCodeLine{93         exit(EXIT\_FAILURE);}
\DoxyCodeLine{94     \}}
\DoxyCodeLine{95 \}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{exec_2main_8c_aa006daaf11f1e2e45a6ababaf463212b}\label{exec_2main_8c_aa006daaf11f1e2e45a6ababaf463212b}} 
\index{main.c@{main.c}!environ@{environ}}
\index{environ@{environ}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{environ}{environ}}
{\footnotesize\ttfamily char$\ast$$\ast$ environ\hspace{0.3cm}{\ttfamily [extern]}}



Referenced by get\+\_\+environ().

