\hypertarget{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test}{}\doxysection{tests.\+unit.\+test\+\_\+intercept.\+Intercept\+Util\+Test Class Reference}
\label{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test}\index{tests.unit.test\_intercept.InterceptUtilTest@{tests.unit.test\_intercept.InterceptUtilTest}}
Inheritance diagram for tests.\+unit.\+test\+\_\+intercept.\+Intercept\+Util\+Test\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test_ae0444baedc05bd8ac5529f00b12cf1ba}{test\+\_\+format\+\_\+entry\+\_\+filters\+\_\+action}} (self)
\item 
def \mbox{\hyperlink{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test_ac891386c151937f1da86ed0c306758a7}{test\+\_\+format\+\_\+entry\+\_\+normalize\+\_\+filename}} (self)
\item 
def \mbox{\hyperlink{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test_a2af331eda994194c3d48967629b2e9db}{test\+\_\+sip}} (self)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 12 of file test\+\_\+intercept.\+py.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test_ae0444baedc05bd8ac5529f00b12cf1ba}\label{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test_ae0444baedc05bd8ac5529f00b12cf1ba}} 
\index{tests.unit.test\_intercept.InterceptUtilTest@{tests.unit.test\_intercept.InterceptUtilTest}!test\_format\_entry\_filters\_action@{test\_format\_entry\_filters\_action}}
\index{test\_format\_entry\_filters\_action@{test\_format\_entry\_filters\_action}!tests.unit.test\_intercept.InterceptUtilTest@{tests.unit.test\_intercept.InterceptUtilTest}}
\doxysubsubsection{\texorpdfstring{test\_format\_entry\_filters\_action()}{test\_format\_entry\_filters\_action()}}
{\footnotesize\ttfamily def tests.\+unit.\+test\+\_\+intercept.\+Intercept\+Util\+Test.\+test\+\_\+format\+\_\+entry\+\_\+filters\+\_\+action (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 14 of file test\+\_\+intercept.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{14     \textcolor{keyword}{def }test\_format\_entry\_filters\_action(self):}
\DoxyCodeLine{15         \textcolor{keyword}{def }\mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}(command):}
\DoxyCodeLine{16             trace = \{\textcolor{stringliteral}{'command'}: command, \textcolor{stringliteral}{'directory'}: \textcolor{stringliteral}{'/opt/src/project'}\}}
\DoxyCodeLine{17             \textcolor{keywordflow}{return} list(sut.format\_entry(trace))}
\DoxyCodeLine{18 }
\DoxyCodeLine{19         self.assertTrue(\mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}([\textcolor{stringliteral}{'cc'}, \textcolor{stringliteral}{'-\/c'}, \textcolor{stringliteral}{'file.c'}, \textcolor{stringliteral}{'-\/o'}, \textcolor{stringliteral}{'file.o'}]))}
\DoxyCodeLine{20         self.assertFalse(\mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}([\textcolor{stringliteral}{'cc'}, \textcolor{stringliteral}{'-\/E'}, \textcolor{stringliteral}{'file.c'}]))}
\DoxyCodeLine{21         self.assertFalse(\mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}([\textcolor{stringliteral}{'cc'}, \textcolor{stringliteral}{'-\/MM'}, \textcolor{stringliteral}{'file.c'}]))}
\DoxyCodeLine{22         self.assertFalse(\mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}([\textcolor{stringliteral}{'cc'}, \textcolor{stringliteral}{'this.o'}, \textcolor{stringliteral}{'that.o'}, \textcolor{stringliteral}{'-\/o'}, \textcolor{stringliteral}{'a.out'}]))}
\DoxyCodeLine{23 }

\end{DoxyCode}


References test().

\mbox{\Hypertarget{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test_ac891386c151937f1da86ed0c306758a7}\label{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test_ac891386c151937f1da86ed0c306758a7}} 
\index{tests.unit.test\_intercept.InterceptUtilTest@{tests.unit.test\_intercept.InterceptUtilTest}!test\_format\_entry\_normalize\_filename@{test\_format\_entry\_normalize\_filename}}
\index{test\_format\_entry\_normalize\_filename@{test\_format\_entry\_normalize\_filename}!tests.unit.test\_intercept.InterceptUtilTest@{tests.unit.test\_intercept.InterceptUtilTest}}
\doxysubsubsection{\texorpdfstring{test\_format\_entry\_normalize\_filename()}{test\_format\_entry\_normalize\_filename()}}
{\footnotesize\ttfamily def tests.\+unit.\+test\+\_\+intercept.\+Intercept\+Util\+Test.\+test\+\_\+format\+\_\+entry\+\_\+normalize\+\_\+filename (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 24 of file test\+\_\+intercept.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{24     \textcolor{keyword}{def }test\_format\_entry\_normalize\_filename(self):}
\DoxyCodeLine{25         parent = os.path.join(os.sep, \textcolor{stringliteral}{'home'}, \textcolor{stringliteral}{'me'})}
\DoxyCodeLine{26         current = os.path.join(parent, \textcolor{stringliteral}{'project'})}
\DoxyCodeLine{27 }
\DoxyCodeLine{28         \textcolor{keyword}{def }\mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}(filename):}
\DoxyCodeLine{29             trace = \{\textcolor{stringliteral}{'directory'}: current, \textcolor{stringliteral}{'command'}: [\textcolor{stringliteral}{'cc'}, \textcolor{stringliteral}{'-\/c'}, filename]\}}
\DoxyCodeLine{30             \textcolor{keywordflow}{return} list(sut.format\_entry(trace))[0][\textcolor{stringliteral}{'file'}]}
\DoxyCodeLine{31 }
\DoxyCodeLine{32         self.assertEqual(os.path.join(current, \textcolor{stringliteral}{'file.c'}), \mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}(\textcolor{stringliteral}{'file.c'}))}
\DoxyCodeLine{33         self.assertEqual(os.path.join(current, \textcolor{stringliteral}{'file.c'}), \mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}(\textcolor{stringliteral}{'./file.c'}))}
\DoxyCodeLine{34         self.assertEqual(os.path.join(parent, \textcolor{stringliteral}{'file.c'}), \mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}(\textcolor{stringliteral}{'../file.c'}))}
\DoxyCodeLine{35         self.assertEqual(os.path.join(current, \textcolor{stringliteral}{'file.c'}),}
\DoxyCodeLine{36                          \mbox{\hyperlink{_function_call_decls_8cpp_ae1a3968e7947464bee7714f6d43b7002}{test}}(os.path.join(current, \textcolor{stringliteral}{'file.c'})))}
\DoxyCodeLine{37 }

\end{DoxyCode}


References test().

\mbox{\Hypertarget{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test_a2af331eda994194c3d48967629b2e9db}\label{classtests_1_1unit_1_1test__intercept_1_1_intercept_util_test_a2af331eda994194c3d48967629b2e9db}} 
\index{tests.unit.test\_intercept.InterceptUtilTest@{tests.unit.test\_intercept.InterceptUtilTest}!test\_sip@{test\_sip}}
\index{test\_sip@{test\_sip}!tests.unit.test\_intercept.InterceptUtilTest@{tests.unit.test\_intercept.InterceptUtilTest}}
\doxysubsubsection{\texorpdfstring{test\_sip()}{test\_sip()}}
{\footnotesize\ttfamily def tests.\+unit.\+test\+\_\+intercept.\+Intercept\+Util\+Test.\+test\+\_\+sip (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 38 of file test\+\_\+intercept.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{38     \textcolor{keyword}{def }test\_sip(self):}
\DoxyCodeLine{39         \textcolor{keyword}{def }create\_status\_report(filename, message):}
\DoxyCodeLine{40             content = \textcolor{stringliteral}{"{}"{}"{}\#!/usr/bin/env sh}}
\DoxyCodeLine{41 \textcolor{stringliteral}{                         echo 'sa-\/la-\/la-\/la'}}
\DoxyCodeLine{42 \textcolor{stringliteral}{                         echo 'la-\/la-\/la'}}
\DoxyCodeLine{43 \textcolor{stringliteral}{                         echo '\{0\}'}}
\DoxyCodeLine{44 \textcolor{stringliteral}{                         echo 'sa-\/la-\/la-\/la'}}
\DoxyCodeLine{45 \textcolor{stringliteral}{                         echo 'la-\/la-\/la'}}
\DoxyCodeLine{46 \textcolor{stringliteral}{                      "{}"{}"{}}.format(message)}
\DoxyCodeLine{47             lines = [line.strip() \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} content.split(\textcolor{stringliteral}{'\(\backslash\)n'})]}
\DoxyCodeLine{48             \textcolor{keyword}{with} \mbox{\hyperlink{namespacestartfile_aa582f75134b683dc321c07d01ff8e501}{open}}(filename, \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} handle:}
\DoxyCodeLine{49                 handle.write(\textcolor{stringliteral}{'\(\backslash\)n'}.join(lines))}
\DoxyCodeLine{50                 handle.close()}
\DoxyCodeLine{51             os.chmod(filename, 0x1ff)}
\DoxyCodeLine{52 }
\DoxyCodeLine{53         \textcolor{keyword}{def }create\_csrutil(dest\_dir, status):}
\DoxyCodeLine{54             filename = os.path.join(dest\_dir, \textcolor{stringliteral}{'csrutil'})}
\DoxyCodeLine{55             message = \textcolor{stringliteral}{'System Integrity Protection status: \{0\}'}.format(status)}
\DoxyCodeLine{56             \textcolor{keywordflow}{return} create\_status\_report(filename, message)}
\DoxyCodeLine{57 }
\DoxyCodeLine{58         \textcolor{keyword}{def }create\_sestatus(dest\_dir, status):}
\DoxyCodeLine{59             filename = os.path.join(dest\_dir, \textcolor{stringliteral}{'sestatus'})}
\DoxyCodeLine{60             message = \textcolor{stringliteral}{'SELinux status:\(\backslash\)t\{0\}'}.format(status)}
\DoxyCodeLine{61             \textcolor{keywordflow}{return} create\_status\_report(filename, message)}
\DoxyCodeLine{62 }
\DoxyCodeLine{63         ENABLED = \textcolor{stringliteral}{'enabled'}}
\DoxyCodeLine{64         DISABLED = \textcolor{stringliteral}{'disabled'}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66         OSX = \textcolor{stringliteral}{'darwin'}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68         \textcolor{keyword}{with} \mbox{\hyperlink{namespacelibear_a44657565063241a3d383ec724243c023}{libear.TemporaryDirectory}}() \textcolor{keyword}{as} tmpdir:}
\DoxyCodeLine{69             saved = os.environ[\textcolor{stringliteral}{'PATH'}]}
\DoxyCodeLine{70             \textcolor{keywordflow}{try}:}
\DoxyCodeLine{71                 os.environ[\textcolor{stringliteral}{'PATH'}] = tmpdir + \textcolor{stringliteral}{':'} + saved}
\DoxyCodeLine{72 }
\DoxyCodeLine{73                 create\_csrutil(tmpdir, ENABLED)}
\DoxyCodeLine{74                 self.assertTrue(sut.is\_preload\_disabled(OSX))}
\DoxyCodeLine{75 }
\DoxyCodeLine{76                 create\_csrutil(tmpdir, DISABLED)}
\DoxyCodeLine{77                 self.assertFalse(sut.is\_preload\_disabled(OSX))}
\DoxyCodeLine{78             \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{79                 os.environ[\textcolor{stringliteral}{'PATH'}] = saved}
\DoxyCodeLine{80 }
\DoxyCodeLine{81         saved = os.environ[\textcolor{stringliteral}{'PATH'}]}
\DoxyCodeLine{82         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{83             os.environ[\textcolor{stringliteral}{'PATH'}] = \textcolor{stringliteral}{''}}
\DoxyCodeLine{84             \textcolor{comment}{\# shall be false when it's not in the path}}
\DoxyCodeLine{85             self.assertFalse(sut.is\_preload\_disabled(OSX))}
\DoxyCodeLine{86 }
\DoxyCodeLine{87             self.assertFalse(sut.is\_preload\_disabled(\textcolor{stringliteral}{'unix'}))}
\DoxyCodeLine{88         \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{89             os.environ[\textcolor{stringliteral}{'PATH'}] = saved}

\end{DoxyCode}


References startfile.\+open(), and libear.\+Temporary\+Directory().



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/\+Users/maximilian/clang-\/llvm/clang/tools/scan-\/build-\/py/tests/unit/\mbox{\hyperlink{test__intercept_8py}{test\+\_\+intercept.\+py}}\end{DoxyCompactItemize}
